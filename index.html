<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bem-Consigo — Sistema de Agendamento</title>
  <link rel="stylesheet" href="style.css" />
  <script>
    const usuario = JSON.parse(localStorage.getItem("logado") || "null");

    if (!usuario) {
      if (!window.location.pathname.includes("login.html")) {
        window.location.href = "login.html";
      }
    } else {
      if (window.location.pathname.includes("login.html")) {
        window.location.href = "index.html";
      }
    }
  </script>
</head>

<body>
<div class="app" id="appRoot">

  <header class="app-header" role="banner">
    <div style="font-size:13px">
      Usuário: <strong id="userDisplay">Administrador</strong>
    </div>
    <div class="brand">
      <img src="logo.png" class="logo" alt="Logo">
    </div>

    <div style="display:flex;gap:12px;align-items:center">
      <div style="font-size:13px">
        Usuário: <strong id="userDisplayHeader">Administrador</strong>
      </div>

      <button class="btn" id="openAppointmentNew">+ Novo</button>
    </div>
  </header>

  <nav class="sidebar" aria-label="Navegação principal">
    <div class="section-title">Menu</div>
    <ul id="mainMenu" role="list">
      <li class="active" data-view="agenda" role="button" tabindex="0">Agenda</li>
      <li data-view="pacientes" role="button" tabindex="0">Pacientes</li>
      <li data-view="profissionais" role="button" tabindex="0">Profissionais</li>
      <li data-view="relatorios" role="button" tabindex="0">Relatórios</li>
    </ul>

    <div class="section-title">Filtro rápido</div>

    <label style="display:block;margin-bottom:8px">
      <select id="filterProfessional" class="input">
        <option value="">Todos os profissionais</option>
      </select>
    </label>

    <label style="display:block;margin-bottom:8px">
      <input type="date" id="filterDate" class="input" />
    </label>

    <button class="btn ghost" id="clearFilters">Limpar filtros</button>
  </nav>

  <main role="main">

    <!-- AGENDA -->
    <section id="view-agenda" class="card view-section">
      <div class="controls">
        <input id="search" class="input" placeholder="Pesquisar…" />
        <select id="statusFilter" class="input">
          <option value="">Todos os status</option>
          <option value="pending">Pendente</option>
          <option value="confirmed">Confirmado</option>
          <option value="cancelled">Cancelado</option>
        </select>
        <select id="serviceFilter" class="input">
          <option value="">Todos os serviços</option>
        </select>

        <label>
          <input type="date" id="filterDateInline" class="input" />
        </label>

        <div style="margin-left:auto;display:flex;gap:8px">
          <button class="btn ghost" id="exportCsv">Exportar CSV</button>
          <button class="btn" id="printBtn">Imprimir</button>
        </div>
      </div>

      <div class="table-wrap" id="listArea">
        <table id="appointmentsTable" aria-live="polite">
          <thead>
            <tr>
              <th>PACIENTE</th>
              <th>PROFISSIONAL</th>
              <th>DATA</th>
              <th>HORA</th>
              <th>SERVIÇO</th>
              <th>AÇÕES</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div class="help">
        Dica: clique em <em>+ Novo</em> para criar um agendamento.
      </div>
    </section>

    <section id="view-pacientes" class="card view-section" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div>
          <div class="section-title-2">Pacientes</div>
          <div class="muted">Cadastre pacientes e faça busca rápida por CPF.</div>
        </div>
        <div>
          <button class="btn" id="openPatientNew">+ Paciente</button>
        </div>
      </div>

      <div class="table-wrap">
        <table id="patientsTable">
          <thead>
            <tr>
              <th>Nome</th>
              <th>CPF</th>
              <th>Telefone</th>
              <th>Observações</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>

      <div style="margin-top:10px">
        <label>
          Buscar por CPF:
          <input id="searchCpf" class="input" placeholder="Digite CPF sem pontos" />
        </label>
      </div>
    </section>
    <section id="view-profissionais" class="card view-section" style="display:none">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div>
          <div class="section-title-2">Profissionais</div>
          <div class="muted">Cadastre profissionais usados nos agendamentos.</div>
        </div>
        <div>
          <button class="btn" id="openProfessionalNew">+ Profissional</button>
        </div>
      </div>

      <div class="table-wrap">
        <table id="professionalsTable">
          <thead>
            <tr>
              <th>Nome</th>
              <th>Especialidade</th>
              <th>Telefone</th>
              <th>Ações</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </section>

    <!-- RELATÓRIOS -->
    <section id="view-relatorios" class="card view-section" style="display:none">
      <div class="section-title-2">Relatórios rápidos</div>
      <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
        <div class="card" style="min-width:220px"><strong id="totalAppts">0</strong><div class="small">Total agendamentos</div></div>
        <div class="card" style="min-width:220px"><strong id="pendingAppts">0</strong><div class="small">Pendentes</div></div>
        <div class="card" style="min-width:220px"><strong id="confirmedAppts">0</strong><div class="small">Confirmados</div></div>
        <div class="card" style="min-width:220px"><strong id="cancelledAppts">0</strong><div class="small">Cancelados</div></div>
      </div>
    </section>

    <footer style="margin-top:20px">
      Sistema Bem-Consigo — Serviços: Terapia, Nutrição, Psicologia, Consulta Geral, Fisioterapia.
    </footer>

  </main>
</div>
<div id="loading" class="loading" style="display:none" aria-hidden="true">
  <div class="loader" aria-label="Carregando"></div>
  <div>Carregando...</div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", () => {
    const usuario = JSON.parse(localStorage.getItem("logado") || "null");
    if (usuario) {
      const userDisplay = document.getElementById("userDisplay");
      const userDisplayHeader = document.getElementById("userDisplayHeader");
      if (userDisplay) userDisplay.textContent = usuario.nome || "Administrador";
      if (userDisplayHeader) userDisplayHeader.textContent = usuario.nome || "Administrador";
    }
  });
</script>

<script src="app.js" defer></script>
</body>
</html>
